import{j as e}from"./index-Duv89VAf.js";import{u as s,r as t}from"./react-vendor-B4gIioy9.js";import{S as a}from"./SafeComponent-DdckI7LM.js";import{W as r}from"./WellnessBreakdown-p6LZOa28.js";import{A as i}from"./AnimatedNumber-WplF5vUS.js";import{g as n}from"./premiumUtils-Ccr3qdNt.js";import{I as l,B as o,x as c,s as d,a as m,m as x,z as h}from"./icons-DVxOjm_j.js";import"./charts-BTXtbyhr.js";function u(){return e.jsxs("div",{className:"card p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})}const p=new class{constructor(e=50){this.cache=new Map,this.maxSize=e}set(e,s,t=3e5){if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,{value:s,expiry:Date.now()+t})}get(e){const s=this.cache.get(e);return s?Date.now()>s.expiry?(this.cache.delete(e),null):s.value:null}has(e){return null!==this.get(e)}clear(){this.cache.clear()}delete(e){this.cache.delete(e)}size(){return this.cache.size}},g=(e,s)=>0===e.length?0:e.reduce(((e,s)=>e+s.mood),0)/e.length,j=e=>{const s={},t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];e.forEach((e=>{const t=new Date(e.date).getDay();s[t]||(s[t]=[]),s[t].push(e.mood)}));const a={};return Object.entries(s).forEach((([e,s])=>{const r=s.reduce(((e,s)=>e+s),0)/s.length;a[t[e]]={average:r,count:s.length}})),a},y=(e,s)=>g(e)-g(s),b=e=>{if(0===e.length)return{best:null,worst:null};return{best:e.reduce(((e,s)=>s.mood>e.mood?s:e)),worst:e.reduce(((e,s)=>s.mood<e.mood?s:e))}},v=e=>{if(0===e.length)return{current:0,longest:0};const s=e.map((e=>e.date)).sort();let t=1,a=1,r=1;for(let l=1;l<s.length;l++){const e=new Date(s[l-1]);1===(new Date(s[l])-e)/864e5?r++:(a=Math.max(a,r),r=1)}a=Math.max(a,r);const i=(new Date).toISOString().split("T")[0],n=s.indexOf(i);if(-1!==n){t=1;for(let e=n-1;e>=0;e--){const a=new Date(s[e]);if(1!==(new Date(s[e+1])-a)/864e5)break;t++}}else t=0;return{current:t,longest:a}},f={5:{label:"Amazing",emoji:"😊"},4:{label:"Good",emoji:"🙂"},3:{label:"Okay",emoji:"😐"},2:{label:"Low",emoji:"😢"},1:{label:"Struggling",emoji:"😰"}};function N(){const N=s(),[w,k]=t.useState("week"),[S,D]=t.useState([]),[M,T]=t.useState(null),[O,z]=t.useState(!0),{isPremium:W}=n();t.useEffect((()=>{A()}),[w]);const A=async()=>{const e=`insights_${w}`,s=p.get(e);if(s)return D(s.moods),T(s.analysis),void z(!1);const t=JSON.parse(localStorage.getItem("safespace_moods")||"{}"),a=Object.entries(t).map((([e,s])=>({date:e,mood:s.mood,emoji:s.emoji,label:s.label,note:s.note,timestamp:s.timestamp}))).sort(((e,s)=>new Date(e.date)-new Date(s.date))),r=new Date;let i=a;if("week"===w){const e=new Date(r.getTime()-6048e5);i=a.filter((s=>new Date(s.date)>=e))}else if("month"===w){const e=new Date(r.getTime()-2592e6);i=a.filter((s=>new Date(s.date)>=e))}if(D(i),i.length>=3){const s=I(i,a);p.set(e,{moods:i,analysis:s},3e5)}else T(null);z(!1)},I=(e,s)=>{const t=JSON.parse(localStorage.getItem("safespace_user")||"{}"),a=JSON.parse(localStorage.getItem("safespace_user_posts")||"[]"),r=g(e),i=(e=>{const s={1:0,2:0,3:0,4:0,5:0};return e.forEach((e=>{s[e.mood]++})),s})(e),n=j(e),{best:l,worst:o}=b(e),c=v(s),d=(e=>{const s=j(e),t=g(e),a={negative:[],positive:[]};Object.entries(s).forEach((([e,s])=>{s.average<t-.5&&s.count>=2&&a.negative.push(`Often on ${e}s`)})),Object.entries(s).forEach((([e,s])=>{s.average>t+.5&&s.count>=2&&a.positive.push(`${e}s boost your mood`)}));const r=["Saturday","Sunday"],i=Object.entries(s).filter((([e])=>!r.includes(e))).reduce(((e,[,s])=>e+s.average),0)/5;return Object.entries(s).filter((([e])=>r.includes(e))).reduce(((e,[,s])=>e+s.average),0)/2>i+.5&&a.positive.push("Weekends lift your spirits"),a})(e),m=(e=>{if(e.length<3)return[];const s=[],t=g(e),a=j(e),r=v(e),{best:i,worst:n}=b(e);if(t>=4){const t=e.filter((e=>e.mood>=4)).length,a=Math.round(t/e.length*100);s.push({type:"positive",icon:"🎉",title:"You had a great week!",description:`Your mood was positive or better ${a}% of the time. That's wonderful!`,color:"success"})}t<2.5&&s.push({type:"support",icon:"🤗",title:"This week was challenging",description:"Remember that tough times don't last, but resilient people like you do. Consider reaching out for support.",color:"warning"}),a.Monday&&a.Monday.average<t-.5&&s.push({type:"pattern",icon:"📅",title:"Monday blues detected",description:"Your mood tends to dip on Mondays. Consider starting your week with something you enjoy.",color:"primary"}),r.current>=7&&s.push({type:"habit",icon:"✨",title:"You're building a healthy habit",description:"Consistent tracking helps identify patterns. Keep it up!",color:"success"});const l=["Saturday","Sunday"],o=e.filter((e=>{const s=new Date(e.date).toLocaleDateString("en-US",{weekday:"long"});return l.includes(s)}));o.length>=2&&g(o)>t+.5&&s.push({type:"pattern",icon:"🌅",title:"Weekends recharge you",description:"Your mood consistently improves on weekends. Make sure to prioritize rest and activities you enjoy.",color:"secondary"});return s.slice(0,4)})(e,a,t),x=((e,s={})=>{const t=[],a=g(e),r=v(e),i=JSON.parse(localStorage.getItem("safespace_circles")||"[]");return(s.interests||[]).includes("anxiety")&&!i.includes(1)&&t.push({icon:"🌊",title:"Join the Anxiety Support circle",description:"Connect with others who understand your experience",action:"Join Circle",type:"circle"}),r.current<3&&t.push({icon:"⏰",title:"Set a morning mood reminder",description:"Daily check-ins help build awareness and track progress",action:"Set Reminder",type:"habit"}),a<3.5&&t.push({icon:"🫁",title:"Try the 5-minute breathing exercise",description:"Deep breathing can help reduce stress and improve mood",action:"Start Exercise",type:"wellness"}),a>=4&&!i.includes(8)&&t.push({icon:"✨",title:"Share your wins in General Wellness",description:"Your positive energy could inspire others in the community",action:"Share Story",type:"community"}),t.slice(0,4)})(e,t,a);let h=0;if("week"===w&&s.length>=14){const t=s.slice(-14,-7);h=y(e,t)}else if("month"===w&&s.length>=60){const t=s.slice(-60,-30);h=y(e,t)}const u=((e,s)=>Math.round(e.length/s*100))(e,"week"===w?7:"month"===w?30:s.length),p={averageMood:r,breakdown:i,weekdayPatterns:n,best:l,worst:o,streak:c,triggers:d,insights:m,suggestions:x,trend:h,consistencyScore:u,totalEntries:s.length};return T(p),p};if(O)return e.jsx(a,{children:e.jsx("div",{className:"max-w-4xl mx-auto animate-fade-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded-3xl animate-pulse"}),e.jsx(u,{}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(u,{}),e.jsx(u,{})]})]})})});const Y=(()=>{const e="week"===w?7:"month"===w?15:7,s=S.length;return{needed:e,current:s,message:`${s}/${e} days needed for ${"week"===w?"weekly":"month"===w?"monthly":""} insights`}})();return e.jsx(a,{children:e.jsxs("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[e.jsx("div",{className:"card p-4 bg-blue-50 border border-blue-200 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold mb-1 text-gray-900",children:"About Your Insights"}),e.jsx("p",{className:"text-gray-700",children:"These insights are generated from your mood tracking data using pattern recognition algorithms. They are meant to help you understand your emotional patterns, not to diagnose or treat any condition. For professional mental health support, please consult a licensed therapist or counselor."})]})]})}),e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-cyan-500 via-blue-500 to-indigo-600 p-8 mb-6 shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/10 to-transparent"}),e.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white drop-shadow-lg mb-2",children:"Your Insights"}),e.jsx("p",{className:"text-white/90 text-lg",children:"AI-powered patterns and suggestions"})]}),e.jsx("div",{className:"flex gap-2",children:["week","month","all"].map((s=>e.jsx("button",{onClick:()=>k(s),className:"px-4 py-2 rounded-xl font-medium transition-all "+(w===s?"bg-white text-blue-600 shadow-lg scale-105":"bg-white/20 text-white hover:bg-white/30 hover:scale-105"),children:"week"===s?"Week":"month"===s?"Month":"All"},s)))})]})]}),M?e.jsxs(e.Fragment,{children:[W&&e.jsx("div",{className:"mb-6",children:e.jsx(r,{})}),e.jsxs("div",{className:"card p-6 mb-6 hover:shadow-2xl transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-text-primary",children:[(()=>{switch(w){case"week":default:return"This Week";case"month":return"This Month";case"all":return"All Time"}})()," at a Glance"]}),W&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gradient-to-r from-yellow-400 to-orange-400 text-white rounded-full text-sm font-medium",children:[e.jsx(c,{size:16}),"Premium"]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:f[Math.round(M.averageMood)]?.emoji}),e.jsxs("div",{className:"text-2xl font-bold text-text-primary mb-1",children:[e.jsx(i,{value:10*parseFloat(M.averageMood.toFixed(1)),duration:1e3}),e.jsx("span",{className:"text-lg",children:"/50"})]}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Average Mood"}),0!==M.trend&&e.jsxs("div",{className:"text-sm mt-1 "+(M.trend>0?"text-success":"text-warning"),children:[M.trend>0?"↑":"↓"," ",Math.abs(M.trend).toFixed(1)," from last ",w]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Mood Distribution"}),e.jsx("div",{className:"space-y-2",children:Object.entries(M.breakdown).reverse().map((([s,t])=>{const a=t/S.length*100;return t>0?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:f[s]?.emoji}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${a}%`}})}),e.jsx("span",{className:"text-sm text-text-secondary w-8",children:t})]},s):null}))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Your Progress"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"🔥"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-text-primary",children:[e.jsx(i,{value:M.streak.current,duration:800})," day streak"]}),e.jsxs("div",{className:"text-xs text-text-secondary",children:["Longest: ",M.streak.longest," days"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"📊"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-text-primary",children:[e.jsx(i,{value:M.consistencyScore,duration:800}),"% consistent"]}),e.jsxs("div",{className:"text-xs text-text-secondary",children:[e.jsx(i,{value:M.totalEntries,duration:1e3})," total check-ins"]})]})]})]})]})]})]}),M.insights.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white drop-shadow-lg mb-4",children:"Patterns We've Noticed"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:M.insights.map(((s,t)=>e.jsx("div",{className:"card p-4 hover:scale-105 hover:shadow-2xl transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl",children:s.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-text-secondary",children:s.description})]})]})},t)))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"😢"}),"When you feel down"]}),M.triggers.negative.length>0?e.jsx("div",{className:"space-y-2",children:M.triggers.negative.map(((s,t)=>e.jsx("div",{className:"text-sm text-text-secondary bg-gray-50 p-2 rounded-lg",children:s},t)))}):e.jsx("p",{className:"text-sm text-text-secondary",children:"No clear patterns detected yet"})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"😊"}),"What lifts you up"]}),M.triggers.positive.length>0?e.jsx("div",{className:"space-y-2",children:M.triggers.positive.map(((s,t)=>e.jsx("div",{className:"text-sm text-text-secondary bg-success/10 p-2 rounded-lg",children:s},t)))}):e.jsx("p",{className:"text-sm text-text-secondary",children:"Keep logging to discover what helps!"})]})]}),M.suggestions.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white drop-shadow-lg mb-4",children:"Try This Week"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[M.suggestions.map(((s,t)=>e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl",children:s.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-text-secondary mb-3",children:s.description})]})]})}),e.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-xl font-medium hover:bg-primary/90 transition-colors",children:s.action})]},t))),e.jsxs("div",{className:"card p-4 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>N("/resources"),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"text-2xl",children:"📚"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:"Explore Resources"}),e.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Access breathing exercises, articles, and wellness tools"})]})]}),e.jsx("button",{className:"w-full bg-secondary text-white py-2 rounded-xl font-medium hover:bg-secondary/90 transition-colors",children:"Browse Library"})]})]})]}),M.best&&M.worst&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(d,{className:"text-success",size:20}),"Your Best Day"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:M.best.emoji}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:new Date(M.best.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),M.best.note&&e.jsxs("div",{className:"text-sm text-text-secondary mt-1",children:['"',M.best.note.slice(0,60),'..."']})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[e.jsx(m,{className:"text-warning",size:20}),"A Tough Day"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:M.worst.emoji}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:new Date(M.worst.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),e.jsx("div",{className:"text-sm text-text-secondary mt-1",children:"Remember: tough days don't last, but you do 💪"})]})]})]})]}),e.jsx("div",{className:"card p-6 mb-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>N("/resources"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(x,{className:"text-primary",size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-1",children:"Need Support Right Now?"}),e.jsx("p",{className:"text-text-secondary text-sm",children:"Access breathing exercises, crisis resources, and wellness articles"})]}),e.jsx("button",{className:"px-6 py-2 bg-primary text-white rounded-xl font-medium hover:bg-primary/90 transition-colors",children:"Get Help"})]})})]}):e.jsxs("div",{className:"card p-8 text-center mb-6",children:[e.jsx(o,{className:"mx-auto text-primary mb-4",size:48}),e.jsx("h3",{className:"text-xl font-semibold text-text-primary mb-2",children:"Keep logging to unlock insights!"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"We need a bit more data to generate meaningful patterns"}),e.jsx("div",{className:"bg-gray-100 rounded-full h-3 mb-2 max-w-xs mx-auto",children:e.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-300",style:{width:Y.current/Y.needed*100+"%"}})}),e.jsx("p",{className:"text-sm text-text-secondary",children:Y.message})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card p-4 bg-gray-50 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"w-5 h-5 text-gray-600 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-gray-900 mb-1",children:"Privacy First"}),e.jsx("p",{className:"text-gray-700",children:"Your data is private and stored only on your device. Insights are generated locally - we never see your moods or personal information."})]})]})}),e.jsx("div",{className:"card p-4 bg-purple-50 border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-gray-900 mb-1",children:"When to Seek Professional Help"}),e.jsx("p",{className:"text-gray-700",children:"If you're experiencing persistent low moods, anxiety, or thoughts of self-harm, please reach out to a mental health professional. These insights are educational tools, not a substitute for professional care."})]})]})})]})]})})}export{N as default};
